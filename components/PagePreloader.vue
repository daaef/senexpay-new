<template>
  <!-- Background layer - always present when loading -->
  <div
    v-if="isLoading || isTransitioning"
    class="fixed inset-0 z-[9999] bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900"
  ></div>
  
  <!-- Content layer with transition -->
  <Transition
    name="preloader-content"
    @enter="onEnter"
    @leave="onLeave"
  >
    <div
      v-if="isLoading || isTransitioning"
      class="fixed inset-0 z-[10000] flex items-center justify-center pointer-events-none"
    >
      <div class="relative pointer-events-auto">
        <!-- Logo container with pulse animation -->
        <div class="flex items-center justify-center w-48 h-52">
          <svg 
            width="120" 
            height="48" 
            viewBox="0 0 150 32" 
            class="animate-pulse-scale drop-shadow-lg" 
            fill="none" 
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M14.0603 4.13306C14.3384 1.38885 15.9066 -0.0954618 18.1806 0.222436C18.6509 0.289219 19.1026 0.450867 19.5085 0.697567C19.9143 0.944266 20.2659 1.27088 20.5417 1.65757C20.8175 2.04427 21.0119 2.48298 21.113 2.94709C21.2142 3.4112 21.22 3.89103 21.1301 4.35745C20.6603 6.6739 18.8234 7.5902 15.8645 6.90999C13.9317 7.67669 12.1111 8.74258 10.7556 10.4489C9.22707 12.3727 9.26213 14.037 11.0547 15.713C12.3495 16.9215 13.871 17.8915 15.4859 19.114C12.1018 18.8686 8.93727 18.5413 6.18646 16.6971C4.59253 15.6288 4.15081 14.016 5.21187 12.3283C6.16083 10.8542 7.30736 9.51718 8.61942 8.35456C10.2881 6.84922 12.1719 5.57996 14.0603 4.13306Z" fill="white"/>
            <path d="M17.6525 25.6824C18.8865 24.752 20.4009 23.8311 21.6419 22.6296C23.4789 20.8484 23.4205 19.0906 21.5578 17.3609C20.443 16.3277 19.1248 15.5096 17.6711 14.425C18.2882 14.4531 18.7532 14.397 19.1786 14.5045C21.3147 15.0398 23.5374 15.3857 25.5403 16.2389C27.7769 17.1926 28.3449 19.2963 26.7556 21.1172C24.8532 23.3005 22.5114 25.105 20.3425 27.0545C19.9257 27.3876 19.4886 27.6944 19.0337 27.9731C18.606 31.3882 16.6428 32.0941 14.8198 31.7365C13.1488 31.4092 12.0316 29.5556 12.3916 27.91C12.8496 25.8086 14.5464 24.9788 17.6525 25.6824Z" fill="white"/>
            <path d="M23.4369 25.3364C25.2295 23.5716 27.0174 22.0966 28.436 20.3295C29.8341 18.6353 30.9875 16.7532 31.8622 14.7382C33.1664 11.5896 31.7594 8.37794 28.6066 7.02921C27.0992 6.38406 25.3907 6.18771 23.7617 5.84176C23.2008 5.72255 22.6048 5.75761 21.878 5.7132C22.0136 5.22934 22.1141 4.87404 22.2403 4.41589C25.6992 4.40654 29.0086 4.65432 31.9183 6.62716C34.5126 8.38729 35.5783 11.2881 34.3326 14.21C33.4492 16.2833 32.1661 18.2445 30.7802 20.0397C29.1372 22.1714 25.4118 24.6819 23.4369 25.3364Z" fill="white"/>
            <path d="M3.5642 12.9244C3.64133 13.8874 3.70676 14.7266 3.77921 15.6499C1.59165 21.1687 2.86773 23.4804 10.1596 26.9282C10.1082 27.2742 10.0521 27.6505 10.01 27.9427C8.90923 28.7912 3.30244 26.2995 1.53557 24.2939C-1.08436 21.3206 -0.315447 16.8373 3.5642 12.9244Z" fill="white"/>
            <path d="M41.7602 18.4642C41.9659 20.3015 43.7514 21.51 46.1938 21.51C48.5309 21.51 50.216 20.3015 50.216 18.6442C50.216 17.2043 49.2016 16.3441 46.7991 15.7527L44.3965 15.1754C40.9913 14.3526 39.4114 12.7584 39.4114 10.1778C39.4114 6.97781 42.1996 4.78056 46.1564 4.78056C50.0757 4.78056 52.7611 6.97781 52.8499 10.1778H50.05C49.8818 8.32654 48.3533 7.20922 46.119 7.20922C43.8847 7.20922 42.3538 8.34056 42.3538 9.98381C42.3538 11.2951 43.3308 12.0665 45.7193 12.6556L47.762 13.1558C51.5645 14.0557 53.1467 15.5844 53.1467 18.2959C53.1467 21.7648 50.3842 23.9363 45.9904 23.9363C41.8794 23.9363 39.1029 21.8162 38.9229 18.4619H41.7602V18.4642Z" fill="white"/>
            <path d="M66.9803 19.6587C66.5946 22.1271 64.2575 23.8872 61.1608 23.8872C57.19 23.8872 54.7874 21.2014 54.7874 16.9355C54.7874 12.6953 57.2297 9.86694 61.0439 9.86694C64.795 9.86694 67.1345 12.513 67.1345 16.6129V17.5643H57.5896V17.7326C57.5896 20.0841 59.0036 21.6385 61.2262 21.6385C62.8061 21.6385 63.9747 20.8414 64.3486 19.6587H66.9803ZM57.6013 15.6242H64.3603C64.2949 13.5555 62.9861 12.1039 61.0463 12.1039C59.1064 12.1039 57.7415 13.5812 57.6013 15.6242Z" fill="white"/>
            <path d="M69.28 10.11H71.9256V12.3727H71.9911C72.7226 10.83 74.1623 9.87862 76.2446 9.87862C79.2245 9.87862 80.9353 11.7813 80.9353 14.8785V23.6301H78.1471V15.4185C78.1471 13.3872 77.1959 12.2699 75.2701 12.2699C73.3162 12.2699 72.0588 13.6583 72.0588 15.7527V23.6301H69.2847V10.11H69.28Z" fill="white"/>
            <path d="M95.1942 19.6587C94.8085 22.1271 92.4714 23.8872 89.3747 23.8872C85.4039 23.8872 83.0013 21.2014 83.0013 16.9355C83.0013 12.6953 85.4436 9.86694 89.2578 9.86694C93.0089 9.86694 95.3484 12.513 95.3484 16.6129V17.5643H85.8012V17.7326C85.8012 20.0841 87.2152 21.6385 89.4378 21.6385C91.0177 21.6385 92.1863 20.8414 92.5602 19.6587H95.1942ZM85.8129 15.6242H92.5719C92.5065 13.5555 91.1976 12.1039 89.2578 12.1039C87.318 12.1039 85.9555 13.5812 85.8129 15.6242Z" fill="white"/>
            <path d="M102.259 18.6559L99.2654 23.6277H96.2576L100.717 16.8817L96.323 10.11H99.4314L102.386 15.0071H102.437L105.354 10.11H108.413L103.979 16.7929L108.362 23.6301H105.302L102.322 18.6559H102.259Z" fill="white"/>
            <path d="M117.444 5.08678C121.041 5.08678 123.546 7.56686 123.546 11.1783C123.546 14.8014 120.989 17.2955 117.353 17.2955H113.37V23.6301H110.493V5.08678H117.444ZM113.372 14.8785H116.675C119.18 14.8785 120.606 13.5298 120.606 11.19C120.606 8.85014 119.18 7.51543 116.686 7.51543H113.372V14.8785Z" fill="white"/>
            <path d="M124.123 19.7872C124.123 17.4217 125.935 15.9701 129.148 15.7901L132.848 15.5727V14.5326C132.848 13.0296 131.833 12.1296 130.137 12.1296C128.531 12.1296 127.528 12.901 127.285 14.1095H124.665C124.82 11.6668 126.9 9.86928 130.242 9.86928C133.519 9.86928 135.613 11.6037 135.613 14.3152V23.6324H132.953V21.4095H132.89C132.107 22.9125 130.396 23.8638 128.625 23.8638C125.974 23.8615 124.123 22.2159 124.123 19.7872ZM132.848 18.5671V17.5012L129.52 17.7069C127.863 17.8214 126.925 18.5554 126.925 19.7124C126.925 20.8952 127.902 21.6666 129.393 21.6666C131.333 21.6642 132.848 20.3272 132.848 18.5671Z" fill="white"/>
            <path d="M138.501 28.6019V26.3532C138.799 26.3967 139.1 26.4139 139.401 26.4047C140.698 26.4047 141.381 25.8647 141.804 24.4762C141.804 24.4505 142.049 23.6534 142.049 23.6418L137.167 10.11H140.172L143.603 21.1103H143.643L147.074 10.11H150L144.926 24.336C143.769 27.6131 142.446 28.6674 139.632 28.6674C139.255 28.6658 138.877 28.6439 138.501 28.6019Z" fill="white"/>
          </svg>
        </div>
      </div>
      
      <!-- Loading text -->
      <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2">
        <p class="text-white/70 text-sm font-medium animate-pulse">Loading...</p>
      </div>
    </div>
  </Transition>
</template>

<script setup lang="ts">
const { isLoading, isTransitioning, handleInitialLoad } = usePreloader()

const onEnter = () => {
  // Small delay to ensure background is fully rendered
  setTimeout(() => {
    // Content is now visible
  }, 50)
}

const onLeave = () => {
  // Ensure smooth exit transition
}

// Handle initial page load
onMounted(() => {
  handleInitialLoad()
})
</script>

<style scoped>
.preloader-content-enter-active,
.preloader-content-leave-active {
  transition: opacity 0.5s ease;
}

.preloader-content-enter-from,
.preloader-content-leave-to {
  opacity: 0;
}

@keyframes pulse-scale {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
}

.animate-pulse-scale {
  animation: pulse-scale 1.5s ease-in-out infinite;
}

.animate-pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

/* Mobile-specific optimizations */
@media (max-width: 768px) {
  .preloader-content-enter-active,
  .preloader-content-leave-active {
    transition: opacity 0.6s ease;
  }
  
  .animate-pulse-scale {
    animation: pulse-scale 1.8s ease-in-out infinite;
  }
}
</style>
